<Window x:Class="Kanstraction.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Kanstraction 2.2"
        Height="800" Width="1280"
        WindowStartupLocation="CenterScreen"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        WindowState="Maximized"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        FontSize="13">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Top bar -->
            <RowDefinition Height="*"/>
            <!-- Body -->
        </Grid.RowDefinitions>

        <!-- TOP BAR: simple actions -->
        <!--<Border Grid.Row="0" Padding="10"
            Background="{DynamicResource MaterialDesignPaper}"
            BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,0,0,1">
            <DockPanel>
                <StackPanel Orientation="Horizontal" />
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button Content="New Project" Margin="6,0" Style="{StaticResource MaterialDesignOutlinedButton}"
                  Click="NewProject_Click"/>
                    <Button Content="Reporting" Margin="6,0" Style="{StaticResource MaterialDesignOutlinedButton}"
                  Click="Reporting_Click"/>
                    <Button Content="Export" Margin="6,0" Style="{StaticResource MaterialDesignOutlinedButton}"
                  Click="Export_Click"/>
                </StackPanel>
            </DockPanel>
        </Border> -->

        <!-- BODY: Left Rail | Explorer (collapsible) | Splitter | Host -->
        <Grid Grid.Row="1" Background="{DynamicResource MaterialDesignPaper}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="56"/>
                <!-- Left rail -->
                <ColumnDefinition x:Name="ExplorerCol" Width="220"/>
                <!-- Explorer (collapsible) -->
                <ColumnDefinition x:Name="SplitterCol" Width="6"/>
                <!-- Splitter -->
                <ColumnDefinition Width="*"/>
                <!-- Main host -->
            </Grid.ColumnDefinitions>

            <!-- LEFT RAIL -->
            <Border Grid.Column="0" Background="#F4F4F6" BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,0,1,0">
                <StackPanel VerticalAlignment="Stretch" HorizontalAlignment="Center" Margin="0,8">
                    <!-- Projects -->
                    <Button Margin="0,6" Padding="1" ToolTip="{DynamicResource MainWindow_Projects}" Height="30"
                  Click="ProjectsRail_Click"
                  Style="{StaticResource MaterialDesignOutlinedButton}">
                        <TextBlock Text="📁" FontSize="18" HorizontalAlignment="Center"/>
                    </Button>

                    <!-- Admin -->
                    <Button Margin="0,6" Padding="1" ToolTip="{DynamicResource MainWindow_Admin}" Height="30"
                  Click="AdminRail_Click"
                  Style="{StaticResource MaterialDesignOutlinedButton}">
                        <TextBlock Text="⚙️" FontSize="18" HorizontalAlignment="Center"/>
                    </Button>

                    <!-- Backups -->
                    <Button Margin="0,6" Padding="1" ToolTip="{DynamicResource MainWindow_Backups}" Height="30"
                  Click="BackupsRail_Click"
                  Style="{StaticResource MaterialDesignOutlinedButton}">
                        <TextBlock Text="💾" FontSize="18" HorizontalAlignment="Center"/>
                    </Button>
                </StackPanel>
            </Border>

            <!-- PROJECT EXPLORER (visible in Operations) -->
            <Grid Grid.Column="1" Background="{DynamicResource MaterialDesignPaper}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- title -->
                    <RowDefinition Height="Auto"/>
                    <!-- search -->
                    <RowDefinition/>
                    <!-- list -->
                </Grid.RowDefinitions>

                <!-- Title -->
                <Border Grid.Row="0" Padding="6"
                  Background="{DynamicResource MaterialDesignCardBackground}"
                  BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="0,0,0,1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Title -->
                        <TextBlock Text="{DynamicResource MainWindow_Projects}" FontWeight="SemiBold"
                            VerticalAlignment="Center"/>

                        <!-- Add Building button (small, icon-only) -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button Click="NewProject_Click"
                                    Background="#3f51b5"
                                    Style="{StaticResource TinyIconButton}"
                                    ToolTip="{DynamicResource MainWindow_AddProject}">
                                <iconPacks:PackIconFontAwesome Foreground="White" Kind="PlusSolid" Width="12" Height="12"/>
                            </Button>
                            <Button Click="RemoveProject_Click"
                                    Background="#c62828"
                                    Style="{StaticResource TinyIconButton}"
                                    Margin="6,0,0,0"
                                    ToolTip="{DynamicResource MainWindow_RemoveProject}">
                                <iconPacks:PackIconFontAwesome Foreground="White" Kind="TrashSolid" Width="12" Height="12"/>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Search -->
                <DockPanel Grid.Row="1" Margin="10,8,10,0">
                    <TextBox x:Name="ProjectSearchBox"
                   materialDesign:HintAssist.Hint="{DynamicResource MainWindow_SearchProjectsHint}"
                   TextChanged="ProjectSearchBox_TextChanged"
                   Padding="8"
                   Style="{StaticResource MaterialDesignOutlinedTextBox}" />
                </DockPanel>

                <!-- List -->
                <ListView x:Name="ProjectsList" Grid.Row="2" Margin="10"
                  DisplayMemberPath="Name"
                  SelectionChanged="ProjectsList_SelectionChanged" />
            </Grid>

            <!-- Splitter between Explorer and Host -->
            <GridSplitter x:Name="ExplorerSplitter" Grid.Column="2" Width="6" HorizontalAlignment="Stretch"
                    Background="{DynamicResource MaterialDesignDivider}"
                    ResizeBehavior="PreviousAndNext" ShowsPreview="True"/>

            <!-- MAIN HOST: swaps between OperationsView and AdminHubView -->
            <ContentControl x:Name="MainContentHost" Grid.Column="3" />
        </Grid>
    </Grid>
</Window>
